#!/bin/sh
# Run to mark a new releaes in Sentry AND upload source maps to get meaningful
# and messages stack traces. 
#
# TODO: move me to github action that deploys to github pages, this should be 
#       run immediately after that step succeeds.

# Timestamp based release identifier
# eg. myenergy@202312181151
RELEASE=myenergy@`date +%Y%m%d%H%M`

sentry-cli releases new "$RELEASE"
sentry-cli releases files "$RELEASE" upload-sourcemaps . --ext dart
sentry-cli releases files "$RELEASE" upload-sourcemaps "build/web" --ext map --ext js 
sentry-cli releases finalize "$RELEASE"