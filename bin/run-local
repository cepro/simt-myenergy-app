#!/bin/sh
#
# Run web app from the local-stage/.
#
# Pass 'hmce' to override default 'wlce' esco.
#
set -e

. `dirname $0`/library.sh

ENV=dev
BUILD_FLUTTER_VERSION=`getFlutterVersion`
GIT_COMMIT=`getGitCommit`

THIS_PROJECT=`pwd`/`dirname $0`/..
APP_HOME=$THIS_PROJECT/app

if [ "$1" = "hmce" ]; then
  ESCO_NAME=hazelmead
else
  ESCO_NAME=waterlilies
fi
ESCO_HOSTNAME=local.$ESCO_NAME.energy

cd $APP_HOME
echo "\nRun app from $APP_HOME ...\n"
flutter run -d chrome \
  --web-hostname $ESCO_HOSTNAME \
  --web-port 4242 \
  --web-browser-flag "--disable-web-security" \
  --dart-define=ENV=$ENV \
  --dart-define=BUILD_FLUTTER_VERSION=$BUILD_FLUTTER_VERSION \
  --dart-define=GIT_COMMIT=$GIT_COMMIT
  
