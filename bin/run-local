#!/bin/sh
#
# Run web app from the local-stage/.
#
# --export will force a fresh export and patch
#
set -e

. `dirname $0`/library.sh

ENV=dev
BUILD_FLUTTER_VERSION=`getFlutterVersion`
GIT_COMMIT=`getGitCommit`

THIS_PROJECT=`pwd`/`dirname $0`/..
APP_HOME=$THIS_PROJECT/app

if [ "$1" = "hmce" ]; then
  SITE_NAME=hazelmead
else
  SITE_NAME=waterlilies
fi
SITE_HOSTNAME=local.$SITE_NAME.energy

cd $APP_HOME
echo "\nRun app from $APP_HOME ...\n"
flutter run -d chrome \
  --web-hostname $SITE_HOSTNAME \
  --web-port 4242 \
  --web-browser-flag "--disable-web-security" \
  --dart-define=ENV=$ENV \
  --dart-define=BUILD_FLUTTER_VERSION=$BUILD_FLUTTER_VERSION \
  --dart-define=GIT_COMMIT=$GIT_COMMIT
  
